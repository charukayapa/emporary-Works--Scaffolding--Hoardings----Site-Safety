<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Temporary Works: Scaffolding, Hoardings, & Site Safety — Technology 3 CONS5103</title>
  <meta name="description" content="Exam-prep educational site covering scaffolding, hoardings, barriers, NZBC F4/F5, certificate of public use, site safety, with interactive notes, mind map, flashcards, MCQ, and cheat sheet." />
  <style>
    :root{
      --bg:#0f1318;
      --card:#121820;
      --muted:#9097a3;
      --text:#e7edf6;
      --accent:#37d8a7;
      --accent-2:#77a7ff;
      --danger:#ff6b6b;
      --warn:#ffd46b;
      --success:#3bd36a;
      --focus:#9efcff;
      --border:rgba(255,255,255,0.08);
      --shadow:0 10px 25px rgba(0,0,0,0.4);
      --radius:14px;
      --radius-sm:10px;
      --radius-xs:8px;
      --font-sans:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      --mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#0b0f14 0%, var(--bg) 40%, #0b0f14 100%);
      color:var(--text); font-family:var(--font-sans); line-height:1.55;
    }
    a{color:var(--accent-2); text-decoration:none}
    a:focus-visible{outline:2px solid var(--focus); outline-offset:2px; border-radius:6px}
    header{
      position:sticky; top:0; z-index:50; backdrop-filter:saturate(1.3) blur(10px);
      background:rgba(10,12,16,0.7); border-bottom:1px solid var(--border);
    }
    .nav{
      display:flex; align-items:center; gap:16px; padding:12px 16px; max-width:1200px; margin:0 auto;
    }
    .brand{display:flex; align-items:center; gap:12px}
    .brand svg{width:36px; height:36px}
    .brand h1{font-size:18px; margin:0; font-weight:700; letter-spacing:.2px}
    .navlinks{display:flex; flex-wrap:wrap; gap:8px; margin-left:auto}
    .navlinks a, .navlinks button{
      padding:8px 12px; border:1px solid var(--border); border-radius:999px; background:transparent; color:var(--text);
      cursor:pointer; transition:all .2s ease-in-out; font-weight:600;
    }
    .navlinks a:hover, .navlinks button:hover{transform:translateY(-1px); border-color:rgba(255,255,255,0.15)}
    main{max-width:1200px; margin:24px auto; padding:0 16px 80px}
    .section{
      background:linear-gradient(180deg, rgba(255,255,255,0.025) 0%, rgba(255,255,255,0.01) 100%);
      border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow);
      margin:18px 0; overflow:hidden;
    }
    .section header{
      position:relative; background:transparent; border-bottom:1px solid var(--border);
    }
    .section-title{
      display:flex; align-items:center; gap:12px; padding:16px; font-weight:800; letter-spacing:.2px; font-size:18px;
    }
    .section-title .badge{font-size:12px; font-weight:700; color:#0a0c10; background:var(--accent); border-radius:999px; padding:4px 10px}
    .section-content{padding:16px}
    .grid{display:grid; gap:16px}
    @media(min-width:900px){ .grid-2{grid-template-columns:1fr 1fr} .grid-3{grid-template-columns:repeat(3,1fr)} }
    /* Collapsible cards */
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius-sm); box-shadow:var(--shadow);
      overflow:hidden; transition:transform .18s ease, border-color .2s ease;
    }
    .card:hover{transform:translateY(-2px); border-color:rgba(255,255,255,0.12)}
    .card header{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 16px}
    .card h3{margin:0; font-size:16px; letter-spacing:.2px}
    .toggle{
      border:none; background:rgba(255,255,255,0.06); color:var(--text); padding:8px 10px; border-radius:10px; cursor:pointer;
      font-weight:700; transition:all .15s ease;
    }
    .toggle:hover{background:rgba(255,255,255,0.09)}
    .panel{max-height:0; overflow:hidden; transition:max-height .35s ease}
    .panel.open{max-height:800px}
    .panel-inner{padding:0 16px 16px}
    .hl{background:linear-gradient(90deg, rgba(55,216,167,0.15), rgba(119,167,255,0.15)); border-left:3px solid var(--accent); padding:10px 12px; border-radius:10px}
    ul.taglist{display:flex; gap:8px; flex-wrap:wrap; padding:0; margin:10px 0}
    ul.taglist li{list-style:none; font-size:12px; color:#0a0c10; background:var(--accent-2); border-radius:999px; padding:4px 10px; font-weight:700}
    /* Search */
    .searchbar{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .searchbar input{
      width:100%; max-width:480px; padding:10px 12px; border-radius:999px; border:1px solid var(--border);
      background:#0c1218; color:var(--text)
    }
    .searchbar input::placeholder{color:var(--muted)}
    /* Mind map */
    .mindmap{
      background:radial-gradient(60% 60% at 50% 50%, rgba(55,216,167,0.08), rgba(119,167,255,0.06) 60%, transparent 100%);
      border:1px solid var(--border); border-radius:var(--radius-sm); padding:12px; position:relative; min-height:420px;
    }
    .node{
      position:absolute; padding:10px 12px; border-radius:999px; background:#121820; border:1px solid var(--border);
      color:var(--text); font-weight:700; cursor:pointer; transition:transform .15s ease, box-shadow .15s ease;
      box-shadow:0 6px 16px rgba(0,0,0,0.35);
    }
    .node:focus-visible{outline:2px solid var(--focus)}
    .node:hover{transform:translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,0.45)}
    .subnode{
      position:absolute; padding:8px 10px; border-radius:999px; background:#0f141b; border:1px dashed rgba(255,255,255,0.15);
      font-size:12px; opacity:0; transform:scale(.92); pointer-events:none; transition:opacity .2s ease, transform .2s ease;
    }
    .subnode.show{opacity:1; transform:scale(1)}
    .edge{position:absolute; background:linear-gradient(90deg, rgba(119,167,255,0.6), rgba(55,216,167,0.6)); height:2px}
    /* Flashcards */
    .flash-grid{display:grid; gap:16px}
    @media(min-width:800px){ .flash-grid{grid-template-columns:repeat(3,1fr)} }
    .flash{
      perspective:1000px; height:180px; position:relative;
    }
    .flash-inner{
      position:absolute; inset:0; transform-style:preserve-3d; transition:transform .45s cubic-bezier(.2,.8,.2,1);
    }
    .flash.flip .flash-inner{transform:rotateY(180deg)}
    .flash-face{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center; text-align:center; padding:16px;
      border-radius:var(--radius-sm); border:1px solid var(--border); background:#11171f; box-shadow:var(--shadow); backface-visibility:hidden;
    }
    .flash-face.back{transform:rotateY(180deg); background:#0e141b}
    /* Quiz */
    .quiz-controls{display:flex; gap:10px; flex-wrap:wrap; margin-bottom:12px}
    .btn{
      background:#121820; border:1px solid var(--border); color:var(--text); padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:800;
    }
    .btn:hover{border-color:rgba(255,255,255,0.16)}
    .btn.primary{background:linear-gradient(90deg, #2fd29f, #5da6ff); color:#0a0c10}
    .btn.warn{background:#1a1e22; border-color:rgba(255,212,107,0.35); color:var(--warn)}
    .btn.ghost{background:transparent}
    .question{
      background:#11171f; border:1px solid var(--border); border-radius:var(--radius-sm); padding:14px; margin:12px 0;
    }
    .choices{display:grid; gap:8px; margin-top:8px}
    .choice{
      border:1px solid var(--border); border-radius:10px; padding:10px; background:#0e141b; cursor:pointer;
    }
    .choice:hover{border-color:rgba(255,255,255,0.14)}
    .choice[aria-checked="true"]{border-color:var(--accent); background:rgba(55,216,167,0.12)}
    .explain{margin-top:8px; font-size:13px; color:var(--muted)}
    .score{
      font-weight:900; letter-spacing:.3px; padding:8px 12px; border:1px dashed rgba(255,255,255,0.15); border-radius:10px; display:inline-block;
      background:linear-gradient(90deg, rgba(55,216,167,0.08), rgba(119,167,255,0.08))
    }
    .progressbar{height:8px; background:#0b0f14; border:1px solid var(--border); border-radius:999px; overflow:hidden; margin:8px 0 16px}
    .progress{height:100%; background:linear-gradient(90deg, #37d8a7, #77a7ff); width:0%}
    /* Cheat sheet */
    .cheat{
      background:#0e141b; border:1px solid var(--border); border-radius:var(--radius-sm); padding:16px;
    }
    .cheat h4{margin:8px 0 6px; font-size:16px}
    .kbd{
      font-family:var(--mono); background:#0a0f14; border:1px solid var(--border); border-radius:6px; padding:2px 6px; color:var(--accent-2)
    }
    .print-hint{font-size:12px; color:var(--muted)}
    /* Footer */
    footer{max-width:1200px; margin:24px auto; padding:0 16px 40px; color:var(--muted)}
    /* Accessibility helpers */
    [role="region"]{scroll-margin-top:72px}
    .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
    /* Simple SVG illustrations */
    .figure{
      border:1px solid var(--border); border-radius:12px; padding:8px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    }
  </style>
</head>
<body>
  <header aria-label="Top navigation">
    <nav class="nav">
      <div class="brand" aria-label="Site brand">
        <svg viewBox="0 0 120 120" aria-hidden="true">
          <defs>
            <linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#37d8a7"/>
              <stop offset="1" stop-color="#77a7ff"/>
            </linearGradient>
          </defs>
          <circle cx="60" cy="60" r="50" fill="url(#g1)" opacity="0.25"/>
          <path d="M25 75 L60 25 L95 75 Z" fill="none" stroke="url(#g1)" stroke-width="6" />
          <circle cx="60" cy="25" r="6" fill="#37d8a7"/>
          <circle cx="25" cy="75" r="6" fill="#77a7ff"/>
          <circle cx="95" cy="75" r="6" fill="#77a7ff"/>
        </svg>
        <h1>Temporary Works: Scaffolding, Hoardings, & Site Safety</h1>
      </div>
      <div class="navlinks" role="navigation">
        <a href="#learning" role="link">Learning</a>
        <a href="#mindmap" role="link">Mind map</a>
        <a href="#flashcards" role="link">Flashcards</a>
        <a href="#quiz" role="link">MCQ Quiz</a>
        <a href="#cheatsheet" role="link">Cheat sheet</a>
        <button id="printBtn" class="btn ghost" aria-label="Print cheat sheet">Print</button>
      </div>
    </nav>
  </header>

  <main>
    <!-- Learning Section -->
    <section id="learning" class="section" role="region" aria-labelledby="learning-title">
      <header>
        <div class="section-title">
          <span class="badge" aria-hidden="true">Core</span>
          <h2 id="learning-title">Learning section with interactive notes</h2>
        </div>
      </header>
      <div class="section-content">
        <div class="searchbar" role="search">
          <label for="searchInput" class="sr-only">Search keywords</label>
          <input id="searchInput" type="search" placeholder="Search keywords (e.g., 'F4 barriers', 'hoarding height', 'SWL')" aria-label="Search notes by keyword or text" />
          <div id="searchCount" aria-live="polite"></div>
        </div>

        <div class="grid grid-2" id="notesContainer" aria-live="polite">
          <!-- Note 1: Hoardings -->
          <article class="card" data-tags="hoardings barriers F5 gantry chainlink plywood metal cladding 2.0m height noise dust security public access NZBC F5/AS1">
            <header>
              <h3>Hoardings & barriers — purpose and acceptable solutions</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-hoardings">Expand</button>
            </header>
            <div id="panel-hoardings" class="panel" role="region" aria-label="Hoardings details">
              <div class="panel-inner">
                <p class="hl"><strong>Summary:</strong> Hoardings prevent public access, protect from hazards, add security, and can reduce dust/noise. Overhead protection requires a gantry. Acceptable solutions specify heights and materials (NZBC F5/AS1).</p>
                <ul>
                  <li><strong>Height:</strong> Hoardings/fences must be at least 2.0 m on public side.</li>
                  <li><strong>Fences:</strong> Chain-link max grid 50×50 mm, posts ≤ 2.5 m spacing, bottom gap ≤ 100 mm.</li>
                  <li><strong>Cladding:</strong> 19 mm timber, 6 mm ply @ ≤600 mm studs, 9.5 mm ply @ ≤1000 mm studs, or continuous metal with equivalent rigidity.</li>
                  <li><strong>Functions:</strong> Public protection, security, trespass control, hazard warning, dust/noise control, signage.</li>
                  <li><strong>Overhead:</strong> Use gantries for protection above public access.</li>
                </ul>
                <ul class="taglist" aria-label="Keywords">
                  <li>Hoarding</li><li>Barrier</li><li>F5/AS1</li><li>Gantry</li><li>Noise</li><li>Dust</li><li>Security</li>
                </ul>
                <div class="figure" aria-label="Illustration: Hoarding types">
                  <svg viewBox="0 0 600 180" role="img" aria-label="Diagram of chain-link fence and solid hoarding with gantry">
                    <rect x="0" y="0" width="600" height="180" fill="transparent"/>
                    <!-- Chain-link fence -->
                    <rect x="20" y="40" width="160" height="100" fill="#18202a" stroke="#4c5a6a"/>
                    <defs><pattern id="mesh" width="10" height="10" patternUnits="userSpaceOnUse">
                      <path d="M0 0 L10 10 M10 0 L0 10" stroke="#789" stroke-width="0.6"/>
                    </pattern></defs>
                    <rect x="20" y="40" width="160" height="100" fill="url(#mesh)" opacity="0.7"/>
                    <text x="100" y="160" text-anchor="middle" fill="#9fb3cc" font-size="12">Chain-link fence (≥2.0 m)</text>

                    <!-- Solid hoarding -->
                    <rect x="220" y="40" width="160" height="100" fill="#1a222c" stroke="#4c5a6a"/>
                    <line x1="220" y1="80" x2="380" y2="80" stroke="#3ad8a7" stroke-dasharray="4 6"/>
                    <text x="300" y="160" text-anchor="middle" fill="#9fb3cc" font-size="12">Solid hoarding</text>

                    <!-- Gantry -->
                    <rect x="420" y="70" width="160" height="20" fill="#263042" stroke="#4c5a6a"/>
                    <rect x="430" y="90" width="10" height="50" fill="#263042"/>
                    <rect x="560" y="90" width="10" height="50" fill="#263042"/>
                    <text x="500" y="160" text-anchor="middle" fill="#9fb3cc" font-size="12">Gantry (overhead)</text>
                  </svg>
                </div>
              </div>
            </div>
          </article>

          <!-- Note 2: NZBC F4 Safety from falling -->
          <article class="card" data-tags="F4 safety from falling barriers height rigidity strength toeboard rails opening 460mm top rail 1000mm 225mm toeboard 200mm offset">
            <header>
              <h3>NZBC F4 — safety from falling (barrier requirements)</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-f4">Expand</button>
            </header>
            <div id="panel-f4" class="panel" role="region" aria-label="NZBC F4 details">
              <div class="panel-inner">
                <p class="hl"><strong>Core requirements:</strong> Barriers must be continuous, appropriately high/rigid/strong, prevent falls through. Temporary barriers under 3 m falls have modified applicability.</p>
                <ul>
                  <li><strong>Rails:</strong> Top rail at 1000 mm; one or more intermediate rails; max vertical opening 460 mm.</li>
                  <li><strong>Toeboard option:</strong> Toeboard ≥ 225 mm above platform with top rail at 1000 mm.</li>
                  <li><strong>Edge offset:</strong> Barrier rails ≤ 200 mm horizontally from platform edge.</li>
                  <li><strong>Performance intent:</strong> Withstand impact and static pressure of people pressing.</li>
                </ul>
                <ul class="taglist"><li>F4</li><li>Barrier</li><li>Guardrail</li><li>Toeboard</li><li>Openings</li></ul>
                <div class="figure" aria-label="Illustration: Barrier dimensions">
                  <svg viewBox="0 0 600 180" role="img" aria-label="Guardrail and toeboard with dimensions">
                    <rect x="0" y="0" width="600" height="180" fill="transparent"/>
                    <rect x="80" y="40" width="420" height="100" fill="#141b22" stroke="#445264"/>
                    <line x1="90" y1="60" x2="490" y2="60" stroke="#37d8a7" stroke-width="4"/>
                    <line x1="90" y1="100" x2="490" y2="100" stroke="#77a7ff" stroke-width="4"/>
                    <rect x="90" y="120" width="400" height="25" fill="#253043"/>
                    <text x="500" y="62" fill="#37d8a7" font-size="12">Top rail ≈ 1000 mm</text>
                    <text x="500" y="102" fill="#77a7ff" font-size="12">Intermediate rail</text>
                    <text x="500" y="134" fill="#9fb3cc" font-size="12">Toeboard ≥ 225 mm</text>
                    <text x="300" y="160" text-anchor="middle" fill="#9fb3cc" font-size="12">Max opening 460 mm; ≤ 200 mm from edge</text>
                  </svg>
                </div>
              </div>
            </div>
          </article>

          <!-- Note 3: NZBC F5 Construction/Demolition hazards -->
          <article class="card" data-tags="F5 construction demolition hazards objects falling public access barriers difficult to climb no projections gates openings marked children enclosure lifting safe route">
            <header>
              <h3>NZBC F5 — construction and demolition hazards</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-f5">Expand</button>
            </header>
            <div id="panel-f5" class="panel" role="region" aria-label="NZBC F5 details">
              <div class="panel-inner">
                <p class="hl"><strong>Objective:</strong> Safeguard people/property from construction/demolition hazards (falling objects, site hazards, unauthorized entry), and provide safe public routes under lifting/height work.</p>
                <ul>
                  <li><strong>Barriers:</strong> Appropriate height & construction; difficult to climb; no unauthorized openings; doors/gates must not project beyond site; no hazardous projections; clearly marked if hazardous.</li>
                  <li><strong>Children:</strong> Enclose hazards likely to attract unauthorized entry.</li>
                  <li><strong>Public routes:</strong> Provide safe routes under lifting operations or elevated work.</li>
                </ul>
                <ul class="taglist"><li>F5</li><li>Barriers</li><li>Public safety</li><li>Falling objects</li><li>Safe route</li></ul>
                <div class="figure" aria-label="Illustration: Safe route under lifting">
                  <svg viewBox="0 0 600 180" role="img" aria-label="Barrier with marked safe route and lifting zone">
                    <rect x="0" y="0" width="600" height="180" fill="transparent"/>
                    <rect x="40" y="40" width="160" height="100" fill="#18202a" stroke="#4c5a6a"/>
                    <text x="120" y="160" text-anchor="middle" fill="#9fb3cc" font-size="12">Barrier</text>
                    <rect x="220" y="90" width="140" height="20" fill="#37d8a7"/>
                    <text x="290" y="85" text-anchor="middle" fill="#0a0c10" font-size="12">Safe route</text>
                    <rect x="380" y="30" width="160" height="30" fill="#253043"/>
                    <line x1="460" y1="60" x2="460" y2="120" stroke="#ffd46b" stroke-width="4"/>
                    <text x="460" y="140" text-anchor="middle" fill="#ffd46b" font-size="12">Lifting zone</text>
                  </svg>
                </div>
              </div>
            </div>
          </article>

          <!-- Note 4: Certificate of Public Use -->
          <article class="card" data-tags="certificate of public use partial occupation renovations safety plan life safety systems sprinklers fire alarms separation public access zone construction zone">
            <header>
              <h3>Certificate of Public Use — partial operation during construction</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-copu">Expand</button>
            </header>
            <div id="panel-copu" class="panel" role="region" aria-label="Certificate of Public Use details">
              <div class="panel-inner">
                <p class="hl"><strong>Use cases:</strong> Public access before full completion, or renovations while part of the building remains open. Requires a safety plan and operational life safety systems.</p>
                <ul>
                  <li><strong>Safety plan:</strong> Separation of zones, maintained fire alarm/sprinkler/doors/lifts/smoke control/communications/fire separations.</li>
                  <li><strong>Zoning:</strong> Clear hoarding line; public access vs construction zone; overhead protection where needed (tunnels/gantries).</li>
                  <li><strong>Complexity:</strong> Integration during system extensions/upgrades (e.g., sprinklers/alarm).</li>
                </ul>
                <ul class="taglist"><li>Public use</li><li>Safety plan</li><li>Sprinklers</li><li>Fire alarm</li><li>Zoning</li></ul>
                <div class="figure" aria-label="Illustration: Zone separation">
                  <svg viewBox="0 0 600 180" role="img" aria-label="Public access zone separated from construction zone with hoarding">
                    <rect x="0" y="0" width="600" height="180" fill="transparent"/>
                    <rect x="40" y="40" width="240" height="100" fill="#143221" stroke="#37d8a7"/>
                    <text x="160" y="160" text-anchor="middle" fill="#9ff2cf" font-size="12">Public Access Zone</text>
                    <rect x="320" y="40" width="240" height="100" fill="#311a1a" stroke="#ff6b6b"/>
                    <text x="440" y="160" text-anchor="middle" fill="#ffacac" font-size="12">Construction Zone</text>
                    <rect x="290" y="40" width="20" height="100" fill="#253043"/>
                    <text x="300" y="28" text-anchor="middle" fill="#9fb3cc" font-size="12">Hoarding</text>
                  </svg>
                </div>
              </div>
            </div>
          </article>

          <!-- Note 5: Scaffolding Intro & Components -->
          <article class="card" data-tags="scaffolding components guardrail midrail toeboard standards ledgers transoms putlogs bracing lift height inspections register SWL duty">
            <header>
              <h3>Scaffolding — definitions, components, and inspections</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-scaffold">Expand</button>
            </header>
            <div id="panel-scaffold" class="panel" role="region" aria-label="Scaffolding details">
              <div class="panel-inner">
                <p class="hl"><strong>Definition:</strong> Temporary structures supporting workers/materials (including stages, suspended scaffolds, and components). Falls are a leading hazard — use fall protection.</p>
                <ul>
                  <li><strong>Key members:</strong> Standards, ledgers, transoms/putlogs, guardrail/midrail/toeboard, bracing, baseplate/soleboard.</li>
                  <li><strong>Lift height:</strong> ≤ 2.1 m; first lift may be up to 3.0 m; headroom 1.8–2.1 m.</li>
                  <li><strong>Inspections:</strong> Weekly if in use ≥ one week; after events; by certified scaffolder/competent person.</li>
                  <li><strong>Register:</strong> Required over 5 m; record duty, SWL, platforms-per-bay limits (light/medium/heavy/special).</li>
                  <li><strong>Screening:</strong> Mesh/screens/catch decks above public thoroughfares; engineer design when sheeted (wind/dead load increases).</li>
                </ul>
                <ul class="taglist"><li>Standards</li><li>Ledgers</li><li>Transoms</li><li>Guardrail</li><li>SWL</li><li>Duty</li></ul>
                <div class="figure" aria-label="Illustration: Scaffold bay">
                  <svg viewBox="0 0 600 200" role="img" aria-label="Scaffold bay with key labelled components">
                    <rect x="0" y="0" width="600" height="200" fill="transparent"/>
                    <rect x="100" y="60" width="400" height="80" fill="#1a222c" stroke="#445264"/>
                    <line x1="140" y1="60" x2="140" y2="160" stroke="#77a7ff" stroke-width="6"/>
                    <line x1="460" y1="60" x2="460" y2="160" stroke="#77a7ff" stroke-width="6"/>
                    <line x1="140" y1="90" x2="460" y2="90" stroke="#37d8a7" stroke-width="6"/>
                    <line x1="140" y1="120" x2="460" y2="120" stroke="#37d8a7" stroke-width="6"/>
                    <rect x="100" y="60" width="400" height="20" fill="#253043"/>
                    <text x="300" y="55" text-anchor="middle" fill="#9fb3cc" font-size="12">Guardrail / Midrail / Toeboard</text>
                    <text x="140" y="170" text-anchor="middle" fill="#9fb3cc" font-size="12">Standard</text>
                    <text x="300" y="140" text-anchor="middle" fill="#9ff2cf" font-size="12">Ledgers</text>
                    <text x="300" y="110" text-anchor="middle" fill="#9ff2cf" font-size="12">Transoms / Putlogs</text>
                  </svg>
                </div>
              </div>
            </div>
          </article>

          <!-- Note 6: Work at height controls -->
          <article class="card" data-tags="work at height elimination isolation minimisation edge protection safety nets restraint fall arrest management controls PPE">
            <header>
              <h3>Working at height — hierarchy of controls</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-height">Expand</button>
            </header>
            <div id="panel-height" class="panel" role="region" aria-label="Working at height details">
              <div class="panel-inner">
                <p class="hl"><strong>Priority:</strong> Eliminate height work where possible; otherwise isolate/minimise via group controls before personal controls.</p>
                <ul>
                  <li><strong>Eliminate:</strong> Assemble at ground level.</li>
                  <li><strong>Isolate:</strong> Scaffolding, guardrails, edge protection, safety mesh.</li>
                  <li><strong>Minimise:</strong> Safety nets, soft landing, restraint/positioning, fall arrest.</li>
                  <li><strong>Management:</strong> Platforms, trestles; ladders/steps only with controls.</li>
                  <li><strong>PPE:</strong> Helmets, safety boots, harnesses, gloves, hearing protection.</li>
                </ul>
                <ul class="taglist"><li>Eliminate</li><li>Isolate</li><li>Minimise</li><li>PPE</li></ul>
              </div>
            </div>
          </article>

          <!-- Note 7: Electrical proximity -->
          <article class="card" data-tags="electrical proximity power lines distance limits 1kv 11kv 22kv 33kv 66kv 110kv 220kv 4m consent">
            <header>
              <h3>Electrical proximity — minimum distances to power lines</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-power">Expand</button>
            </header>
            <div id="panel-power" class="panel" role="region" aria-label="Electrical proximity details">
              <div class="panel-inner">
                <p class="hl"><strong>Rule of thumb:</strong> Do not erect scaffold or handle materials within 4 m of overhead lines without written consent from the network owner; stricter limits at higher voltages (e.g., 6 m at 220 kV).</p>
                <ul>
                  <li><strong>Examples (min distances):</strong> 0.5 m (≤1 kV), 1.5 m (11 kV), 2.0 m (22 kV), 2.5 m (33 kV), 3.0 m (66 kV), 4.0 m (110 kV), 6.0 m (≥220 kV).</li>
                  <li><strong>Approval:</strong> Some clearances cannot be approved (e.g., up to 6 m at 220 kV) — maintain mandated distances.</li>
                </ul>
                <ul class="taglist"><li>Power lines</li><li>Clearance</li><li>Consent</li></ul>
              </div>
            </div>
          </article>

          <!-- Note 8: Barrier selection table logic -->
          <article class="card" data-tags="barrier selection table distance D height H linkmesh hoarding gantry site boundary">
            <header>
              <h3>Barrier selection — distance (D) & height (H) logic</h3>
              <button class="toggle" aria-expanded="false" aria-controls="panel-table1">Expand</button>
            </header>
            <div id="panel-table1" class="panel" role="region" aria-label="Barrier selection details">
              <div class="panel-inner">
                <p class="hl"><strong>Acceptable barriers:</strong> Based on horizontal distance from site boundary (D) and work height above boundary (H): linkmesh, hoarding, or gantry.</p>
                <ul>
                  <li><strong>D &lt; 3 m:</strong> Gantry (any height).</li>
                  <li><strong>3–15 m:</strong> If H &lt; D → linkmesh; if H between D and 2D → hoarding; if H &gt; 2D → gantry.</li>
                  <li><strong>D &gt; 15 m:</strong> Linkmesh (any height).</li>
                </ul>
                <ul class="taglist"><li>Linkmesh</li><li>Hoarding</li><li>Gantry</li></ul>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- Mind Map -->
    <section id="mindmap" class="section" role="region" aria-labelledby="mindmap-title">
      <header>
        <div class="section-title">
          <span class="badge" aria-hidden="true">Visual</span>
          <h2 id="mindmap-title">Mind map — relationships between key concepts</h2>
        </div>
      </header>
      <div class="section-content">
        <div class="mindmap" id="mindmapCanvas" aria-label="Interactive mind map showing relationships">
          <!-- Nodes -->
          <button class="node" style="left:260px; top:20px" data-node="root" aria-expanded="true">Temporary Works</button>
          <button class="node" style="left:60px; top:120px" data-node="scaffolding" aria-expanded="false">Scaffolding</button>
          <button class="node" style="left:240px; top:300px" data-node="hoardings" aria-expanded="false">Hoardings & Barriers</button>
          <button class="node" style="left:420px; top:120px" data-node="sitesafety" aria-expanded="false">Site Safety</button>
          <button class="node" style="left:460px; top:300px" data-node="legislation" aria-expanded="false">NZBC F4/F5</button>
          <button class="node" style="left:240px; top:200px" data-node="copu" aria-expanded="false">Certificate of Public Use</button>
          <!-- Subnodes (initial hidden) -->
          <div class="subnode" style="left:30px; top:70px" data-parent="scaffolding">Components (rails, ledgers, transoms)</div>
          <div class="subnode" style="left:30px; top:170px" data-parent="scaffolding">Types (standing, cantilevered, suspended)</div>
          <div class="subnode" style="left:200px; top:350px" data-parent="hoardings">Materials (ply, timber, metal)</div>
          <div class="subnode" style="left:200px; top:260px" data-parent="hoardings">Functions (security, dust, noise)</div>
          <div class="subnode" style="left:420px; top:70px" data-parent="sitesafety">Hierarchy (eliminate, isolate, minimise)</div>
          <div class="subnode" style="left:520px; top:160px" data-parent="sitesafety">PPE & hazards</div>
          <div class="subnode" style="left:440px; top:250px" data-parent="legislation">F4 (barriers)</div>
          <div class="subnode" style="left:540px; top:260px" data-parent="legislation">F5 (site hazards)</div>
          <div class="subnode" style="left:210px; top:230px" data-parent="copu">Safety plan & zoning</div>
          <div class="subnode" style="left:300px; top:230px" data-parent="copu">Life safety systems</div>
          <!-- Edges -->
          <div class="edge" style="left:120px; top:110px; width:160px"></div>
          <div class="edge" style="left:280px; top:110px; width:160px"></div>
          <div class="edge" style="left:260px; top:160px; width:0px; height:2px"></div>
          <div class="edge" style="left:260px; top:200px; width:0px; height:2px"></div>
        </div>
        <p class="print-hint">Tip: Click nodes to expand/collapse related subtopics. Keyboard: Tab to node → Enter/Space to toggle.</p>
      </div>
    </section>

    <!-- Flashcards -->
    <section id="flashcards" class="section" role="region" aria-labelledby="flashcards-title">
      <header>
        <div class="section-title">
          <span class="badge" aria-hidden="true">Revision</span>
          <h2 id="flashcards-title">Flashcards — flip for quick definitions</h2>
        </div>
      </header>
      <div class="section-content">
        <div class="flash-grid" id="flashGrid" aria-live="polite">
          <!-- 12 curated flashcards -->
          <!-- We generate programmatically in JS for consistency -->
        </div>
      </div>
    </section>

    <!-- MCQ Quiz -->
    <section id="quiz" class="section" role="region" aria-labelledby="quiz-title">
      <header>
        <div class="section-title">
          <span class="badge" aria-hidden="true">Test</span>
          <h2 id="quiz-title">MCQ quiz — 40 questions with explanations</h2>
        </div>
      </header>
      <div class="section-content">
        <div class="quiz-controls">
          <button id="startQuiz" class="btn primary" aria-label="Start quiz">Start / Shuffle</button>
          <button id="resetQuiz" class="btn warn" aria-label="Reset quiz">Reset</button>
          <button id="reviewMode" class="btn" aria-pressed="false" aria-label="Toggle review mode">Review mode</button>
          <span id="scoreBox" class="score" aria-live="polite">Score: 0 / 0</span>
        </div>
        <div class="progressbar" aria-label="Progress">
          <div id="progress" class="progress"></div>
        </div>
        <div id="quizContainer" aria-live="polite"></div>
      </div>
    </section>

    <!-- Cheat Sheet -->
    <section id="cheatsheet" class="section" role="region" aria-labelledby="cheat-title">
      <header>
        <div class="section-title">
          <span class="badge" aria-hidden="true">Quick</span>
          <h2 id="cheat-title">Cheat sheet — one-page rapid revision</h2>
        </div>
      </header>
      <div class="section-content">
        <div class="cheat" id="cheatContent">
          <h3>Key formulas, dimensions, and thresholds</h3>
          <ul>
            <li><strong>Hoarding/fence height:</strong> ≥ 2.0 m (public side).</li>
            <li><strong>Chain-link fence:</strong> Grid ≤ 50×50 mm; posts ≤ 2.5 m spacing; bottom gap ≤ 100 mm.</li>
            <li><strong>Hoarding cladding:</strong> 19 mm timber OR 6 mm ply @ ≤ 600 mm studs OR 9.5 mm ply @ ≤ 1000 mm studs OR continuous metal (equivalent rigidity).</li>
            <li><strong>Barrier rails (F4):</strong> Top rail 1000 mm; intermediate rails; opening ≤ 460 mm; rail ≤ 200 mm from edge.</li>
            <li><strong>Scaffold lifts:</strong> ≤ 2.1 m; first lift ≤ 3.0 m; headroom 1.8–2.1 m.</li>
            <li><strong>Platforms per bay:</strong> Up to 13.5 m → Light: 4, Medium: 2, Heavy: 2; Up to 33 m → Light: 2, Medium: 1, Heavy: 1.</li>
            <li><strong>SWL by duty:</strong> Light 225 kg (single point 100 kg); Medium 450 kg (150 kg); Heavy 675 kg (200 kg); Special: as designed.</li>
            <li><strong>Electrical proximity:</strong> 0.5 m (≤1 kV), 1.5 m (11 kV), 2.0 m (22 kV), 2.5 m (33 kV), 3.0 m (66 kV), 4.0 m (110 kV), 6.0 m (≥220 kV). Keep ≥ 4 m unless approved; ≥ 220 kV stricter.</li>
          </ul>

          <h3>Barrier selection (by distance D and height H)</h3>
          <ul>
            <li><strong>D &lt; 3 m:</strong> Gantry (any H).</li>
            <li><strong>3–15 m:</strong> If H &lt; D → Linkmesh; D ≤ H ≤ 2D → Hoarding; H &gt; 2D → Gantry.</li>
            <li><strong>D &gt; 15 m:</strong> Linkmesh.</li>
          </ul>

          <h4>Legislation highlights</h4>
          <ul>
            <li><strong>F4 Safety from Falling:</strong> Continuous barriers, appropriate height/rigidity/strength, prevent falls through; construction site specifics for falls &lt; 3 m.</li>
            <li><strong>F5 Construction/Demolition Hazards:</strong> Prevent falling objects; barriers must be hard to climb, no hazardous projections, controlled openings, marked; enclose child-attractive hazards; safe public routes under lifting/elevated work.</li>
            <li><strong>Certificate of Public Use:</strong> Safety plan for zone separation; life safety systems operational (fire alarms, sprinklers, doors, lifts, smoke control, comms, separations).</li>
          </ul>

          <h4>Working at height hierarchy</h4>
          <ul>
            <li><strong>Eliminate:</strong> Avoid height work (assemble at ground).</li>
            <li><strong>Isolate:</strong> Scaffolds, guardrails, edge protection, safety mesh.</li>
            <li><strong>Minimise:</strong> Nets, soft landing, restraint, positioning, fall arrest.</li>
            <li><strong>PPE:</strong> Helmets, boots, harnesses, gloves, hearing protection.</li>
          </ul>

          <p class="print-hint"><span class="kbd">Ctrl/Cmd + P</span> or use the Print button to export/print this cheat sheet.</p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>Technology 3 CONS5103 — Portfolio-ready exam prep site. Dark theme, accessible, and responsive. Built for clean study flow, fast revision, and professional presentation.</p>
  </footer>

  <script>
    /* Accessibility + performance helpers */
    const qs = (sel, el=document) => el.querySelector(sel);
    const qsa = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    /* Collapsible cards */
    qsa('.card .toggle').forEach(btn=>{
      const panelId = btn.getAttribute('aria-controls');
      const panel = qs('#'+panelId);
      btn.addEventListener('click', ()=>{
        const open = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!open));
        panel.classList.toggle('open', !open);
        // Smooth expand height calculation
        if(!open){
          panel.style.maxHeight = panel.scrollHeight+'px';
          setTimeout(()=> panel.style.maxHeight = '800px', 180);
        }else{
          panel.style.maxHeight = '0px';
        }
      });
      // Keyboard toggle
      btn.addEventListener('keydown', (e)=>{
        if(e.key==='Enter' || e.key===' '){ e.preventDefault(); btn.click(); }
      });
    });

    /* Search: filter notes by keyword/text */
    const searchInput=qs('#searchInput'), notesContainer=qs('#notesContainer'), searchCount=qs('#searchCount');
    const noteCards=qsa('.card', notesContainer);
    const normalize=(s)=> s.toLowerCase().replace(/\s+/g,' ').trim();
    searchInput.addEventListener('input', ()=>{
      const term=normalize(searchInput.value);
      let visible=0;
      noteCards.forEach(card=>{
        const tags=card.getAttribute('data-tags')||'';
        const text=normalize(card.textContent||'');
        const match=!term || tags.toLowerCase().includes(term) || text.includes(term);
        card.style.display = match ? '' : 'none';
        visible += match ? 1 : 0;
      });
      searchCount.textContent = term ? `Showing ${visible} of ${noteCards.length}` : '';
    });

    /* Mind map: toggle subnodes */
    const nodes=qsa('.node');
    const subnodes=qsa('.subnode');
    nodes.forEach(n=>{
      n.addEventListener('click', ()=>{
        const key = n.getAttribute('data-node');
        const expanded = n.getAttribute('aria-expanded')==='true';
        n.setAttribute('aria-expanded', String(!expanded));
        subnodes.forEach(s=>{
          const parent=s.getAttribute('data-parent');
          if(parent===key){ s.classList.toggle('show', !expanded); }
        });
      });
      n.addEventListener('keydown', (e)=>{
        if(e.key==='Enter' || e.key===' '){ e.preventDefault(); n.click(); }
      });
    });

    /* Flashcards: generate and flip */
    const flashData = [
      {q:'Hoarding (site fence) — primary purpose?', a:'Prevent public access, reduce risk of injury, add security, dust/noise control.'},
      {q:'When is a gantry required?', a:'When overhead protection is needed above public access (work above public thoroughfare).'},
      {q:'Chain-link acceptable fence spec?', a:'Grid ≤ 50×50 mm; posts ≤ 2.5 m spacing; bottom gap ≤ 100 mm.'},
      {q:'Hoarding continuous cladding options?', a:'19 mm timber; 6 mm ply @ ≤600 mm; 9.5 mm ply @ ≤1000 mm; continuous metal (equivalent rigidity).'},
      {q:'F4 barrier basics?', a:'Continuous, appropriate height, rigid, strong, prevent falls through; top rail 1000 mm.'},
      {q:'F4 site barrier openings?', a:'Max vertical opening 460 mm; rails ≤ 200 mm from platform edge.'},
      {q:'F5 barrier characteristics?', a:'Difficult to climb; controlled openings; no projections; clearly marked if hazardous.'},
      {q:'Certificate of Public Use — what must be operational?', a:'Life safety systems: alarms, sprinklers, doors, lifts, smoke control, comms, fire separations.'},
      {q:'Scaffold lift height and headroom?', a:'Lift ≤ 2.1 m (first ≤ 3.0 m); headroom 1.8–2.1 m when used as walkway.'},
      {q:'Platforms per bay (≤13.5 m)?', a:'Light: 4; Medium: 2; Heavy: 2.'},
      {q:'Platforms per bay (≤33 m)?', a:'Light: 2; Medium: 1; Heavy: 1.'},
      {q:'SWL by duty?', a:'Light 225 kg (100 kg point); Medium 450 kg (150 kg); Heavy 675 kg (200 kg); Special as designed.'}
    ];
    const flashGrid=qs('#flashGrid');
    flashData.forEach((f,i)=>{
      const card=document.createElement('div');
      card.className='flash';
      card.setAttribute('tabindex','0');
      card.setAttribute('role','button');
      card.setAttribute('aria-pressed','false');
      card.innerHTML=`
        <div class="flash-inner">
          <div class="flash-face front"><strong>${i+1}.</strong>&nbsp;${f.q}</div>
          <div class="flash-face back">${f.a}</div>
        </div>`;
      card.addEventListener('click', ()=>{
        const flipped=card.classList.toggle('flip');
        card.setAttribute('aria-pressed', String(flipped));
      });
      card.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); card.click(); }});
      flashGrid.appendChild(card);
    });

    /* Quiz: 40 MCQs */
    const quizData = [
      {q:'Hoardings primarily serve to:', opts:['Decorate the site perimeter','Prevent public access and protect from hazards','Support scaffold standards','Increase wind load on structures'], ans:1, exp:'Hoardings reduce public risk and provide security/dust/noise control; access prevention is the core function.'},
      {q:'Overhead protection for public thoroughfares is typically provided by:', opts:['Guardrails','Midrails','Gantry structures','Toe boards'], ans:2, exp:'A gantry provides overhead protection when work occurs above public access.'},
      {q:'Minimum height for fences/hoardings on public side:', opts:['1.0 m','1.5 m','2.0 m','2.5 m'], ans:2, exp:'NZBC F5/AS1: Fences/hoardings ≥ 2.0 m on the public-accessible side.'},
      {q:'Acceptable chain-link fence grid size:', opts:['25×25 mm','50×50 mm','75×75 mm','100×100 mm'], ans:1, exp:'Grid must be ≤ 50×50 mm to prevent access/objects through.'},
      {q:'Max post spacing for chain-link fence:', opts:['1.0 m','1.5 m','2.5 m','3.0 m'], ans:2, exp:'Posts at ≤ 2.5 m spacing for structural adequacy.'},
      {q:'Max bottom gap beneath fence:', opts:['50 mm','75 mm','100 mm','150 mm'], ans:2, exp:'Gap ≤ 100 mm to deter entry/under-crawl.'},
      {q:'Hoarding cladding option with 6 mm ply requires studs at:', opts:['400 mm centers','600 mm centers','800 mm centers','1000 mm centers'], ans:1, exp:'6 mm exterior ply on studs at ≤ 600 mm centers.'},
      {q:'Hoarding cladding option with 9.5 mm ply allows studs at:', opts:['600 mm centers','800 mm centers','1000 mm centers','1200 mm centers'], ans:2, exp:'9.5 mm exterior ply on studs at ≤ 1000 mm centers.'},
      {q:'NZBC F4 requires top rail height of:', opts:['900 mm','1000 mm','1100 mm','1200 mm'], ans:1, exp:'Top rail typically at 1000 mm height.'},
      {q:'Max vertical opening between rails under F4:', opts:['225 mm','300 mm','460 mm','600 mm'], ans:2, exp:'Opening ≤ 460 mm to prevent falls through.'},
      {q:'Toeboard height above platform per F4 option:', opts:['150 mm','200 mm','225 mm','300 mm'], ans:2, exp:'Toeboard must extend ≥ 225 mm.'},
      {q:'Barrier rails must be within how far from platform edge?', opts:['100 mm','150 mm','200 mm','250 mm'], ans:2, exp:'Rails ≤ 200 mm horizontally from platform edge.'},
      {q:'F5 requires barriers to be:', opts:['Easy to climb','Difficult to climb','Made only of timber','Transparent'], ans:1, exp:'Barriers must be difficult to climb, with controlled openings and no projections.'},
      {q:'When work occurs above public routes, F5 requires:', opts:['Removing public access entirely','Providing safe routes or protection','Only signage','Night-only work'], ans:1, exp:'Provide a safe route (e.g., tunnel/gantry) where lifting/elevated work presents risk.'},
      {q:'Barrier selection: D &lt; 3 m regardless of H →', opts:['Linkmesh fence','Hoarding','Gantry','No barrier'], ans:2, exp:'At distances <3 m from boundary, gantry is required to protect overhead hazards.'},
      {q:'Barrier selection: D between 3–15 m and H &lt; D →', opts:['Linkmesh fence','Hoarding','Gantry','No barrier'], ans:0, exp:'Linkmesh is acceptable when height is less than distance.'},
      {q:'Barrier selection: D between 3–15 m and D ≤ H ≤ 2D →', opts:['Linkmesh fence','Hoarding','Gantry','No barrier'], ans:1, exp:'Hoarding provides side protection when height is between D and 2D.'},
      {q:'Barrier selection: D between 3–15 m and H &gt; 2D →', opts:['Linkmesh fence','Hoarding','Gantry','No barrier'], ans:2, exp:'Gantry needed due to increased overhead hazard.'},
      {q:'Barrier selection: D &gt; 15 m any H →', opts:['Linkmesh fence','Hoarding','Gantry','No barrier'], ans:0, exp:'Linkmesh acceptable beyond 15 m.'},
      {q:'Scaffold lift height limit (typical):', opts:['1.5 m','2.1 m','2.4 m','3.0 m'], ans:1, exp:'Standard lift height ≤ 2.1 m; first lift may be ≤ 3.0 m.'},
      {q:'First lift may be up to:', opts:['2.1 m','2.4 m','3.0 m','3.3 m'], ans:2, exp:'First lift can be ≤ 3.0 m per typical guidance.'},
      {q:'Headroom when used as walkway:', opts:['1.6–1.9 m','1.7–2.0 m','1.8–2.1 m','2.0–2.3 m'], ans:2, exp:'Provide 1.8–2.1 m headroom.'},
      {q:'Platforms per bay up to 13.5 m (Light/Medium/Heavy):', opts:['4/3/2','4/2/2','3/2/1','2/2/2'], ans:1, exp:'Light: 4; Medium: 2; Heavy: 2.'},
      {q:'Platforms per bay up to 33 m (Light/Medium/Heavy):', opts:['3/2/2','2/2/1','2/1/1','1/1/1'], ans:2, exp:'Light: 2; Medium: 1; Heavy: 1.'},
      {q:'SWL (Light duty) per platform:', opts:['100 kg','225 kg','450 kg','675 kg'], ans:1, exp:'Light duty platform SWL ~225 kg; single point load 100 kg.'},
      {q:'SWL (Medium duty) per platform:', opts:['225 kg','450 kg','675 kg','900 kg'], ans:1, exp:'Medium duty ~450 kg; single point 150 kg.'},
      {q:'SWL (Heavy duty) per platform:', opts:['450 kg','600 kg','675 kg','750 kg'], ans:2, exp:'Heavy duty ~675 kg; single point 200 kg.'},
      {q:'Scaffold inspections should be by:', opts:['Any worker','Certified scaffolder or competent person','Only the client','Only council'], ans:1, exp:'Certified scaffolder/competent person per type and schedule.'},
      {q:'Scaffold register is required for:', opts:['Any scaffold','Only domestic scaffolds','Scaffolds over 5 m','Only suspended scaffolds'], ans:2, exp:'Register for scaffolds over 5 m with regular inspection records.'},
      {q:'Containment sheeting effect:', opts:['Reduces wind load','No effect on loads','Increases wind and dead load','Only aesthetic'], ans:2, exp:'Sheeting increases wind and dead load; often needs engineered design and ties.'},
      {q:'Working at height priority:', opts:['Use fall arrest first','Eliminate height if possible','Always use ladders','Rely on PPE only'], ans:1, exp:'Elimination is preferred; then isolation/group controls, then personal minimisation/PPE.'},
      {q:'F5 requires barriers to have:', opts:['Projections to deter entry','Gates projecting beyond site','No hazardous projections and controlled openings','Transparent mesh only'], ans:2, exp:'No hazardous projections; openings controlled; gates must not project beyond site.'},
      {q:'Children-attractive hazards must be:', opts:['Left open for ventilation','Enclosed to restrict access','Marked only with signage','Guarded during work hours only'], ans:1, exp:'Enclose hazards likely to attract unauthorized entry by children.'},
      {q:'Electrical proximity to 110 kV lines:', opts:['1.5 m','2.0 m','3.0 m','4.0 m'], ans:3, exp:'Typical minimum ~4.0 m; maintain ≥4 m and seek written consent for closer work (if permitted).'},
      {q:'Electrical proximity to 220 kV lines:', opts:['3.0 m','4.0 m','5.0 m','6.0 m'], ans:3, exp:'Minimum ~6.0 m; stricter and may not be approvable below distance.'},
      {q:'Public use during renovations requires:', opts:['No separation of zones','Certificate of Public Use with safety plan','Temporary removal of fire alarms','Only PPE for public'], ans:1, exp:'Certificate of Public Use and a council-accepted safety plan with maintained life safety systems.'},
      {q:'F4 performance intent includes ability to:', opts:['Flex easily','Withstand foreseeable impact/static pressure of people','Support heavy machinery','Carry vehicle loads'], ans:1, exp:'Barriers must resist impacts and static pressing by people.'},
      {q:'Scaffold screening above public areas should include:', opts:['Toe-only boards','Robust screens/mesh and catch screens','Only signage','Open platforms'], ans:1, exp:'Screen platforms and add catch screens where needed; engineer design when sheeted.'},
      {q:'Weekly inspection requirement applies to scaffolds:', opts:['Regardless of height if in use ≥ one week','Only over 10 m','Only suspended','Only domestic'], ans:0, exp:'Weekly inspections generally apply to scaffolds in use ≥ one week, plus after events.'},
      {q:'Barrier selection logic compares:', opts:['Wind speed and temperature','Distance (D) and height (H)','Worker count and hours','Noise and dust only'], ans:1, exp:'Acceptable barrier depends on D (distance to boundary) and H (height above boundary).'}
    ];
    // Ensure we have 40 questions:
    while(quizData.length < 40){
      // Add varied reinforcement questions
      quizData.push({q:'Which member spans between standards to support platform boards?', opts:['Ledger','Transom/Putlog','Standard','Baseplate'], ans:1, exp:'Transoms/putlogs sit transverse between ledgers/standards to carry platform.'});
    }

    const quizContainer=qs('#quizContainer'), startQuiz=qs('#startQuiz'), resetQuiz=qs('#resetQuiz'), reviewBtn=qs('#reviewMode'), progress=qs('#progress'), scoreBox=qs('#scoreBox');
    let state = { order:[], answers:{}, score:0, total:0, review:false };

    function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr; }
    function renderQuiz(){
      quizContainer.innerHTML='';
      state.order.forEach((idx,number)=>{
        const item=quizData[idx];
        const qEl=document.createElement('div'); qEl.className='question';
        qEl.setAttribute('role','group'); qEl.setAttribute('aria-labelledby',`q-${number}`);
        const checked = state.answers[idx];
        qEl.innerHTML=`
          <div id="q-${number}" style="font-weight:800">${number+1}. ${item.q}</div>
          <div class="choices" role="radiogroup" aria-label="Choices for question ${number+1}">
            ${item.opts.map((opt, i)=>`
              <div class="choice" tabindex="0" role="radio" aria-checked="${checked===i}" data-q="${idx}" data-choice="${i}">
                ${String.fromCharCode(65+i)}. ${opt}
              </div>`).join('')}
          </div>
          <div class="explain" ${state.review || (checked!==undefined && (checked===item.ans)) ? '' : 'style="display:none"'}>${item.exp}</div>
        `;
        quizContainer.appendChild(qEl);
      });
      updateProgress();
      updateScore();
      attachChoiceHandlers();
    }
    function attachChoiceHandlers(){
      qsa('.choice', quizContainer).forEach(ch=>{
        ch.addEventListener('click', ()=>{
          const q = Number(ch.getAttribute('data-q'));
          const choice = Number(ch.getAttribute('data-choice'));
          state.answers[q] = choice;
          // Update aria-checked
          qsa(`.choice[data-q="${q}"]`, quizContainer).forEach(c=> c.setAttribute('aria-checked', String(Number(c.getAttribute('data-choice'))===choice)));
          // Show explanation if correct or in review
          const parent = ch.closest('.question');
          const item = quizData[state.order.findIndex(i=>i===q)] ? quizData[q] : quizData[q];
          const exp = qs('.explain', parent);
          if(state.review || choice===item.ans){ exp.style.display=''; } else { exp.style.display='none'; }
          updateScore();
        });
        ch.addEventListener('keydown', (e)=>{
          if(e.key==='Enter' || e.key===' '){ e.preventDefault(); ch.click(); }
        });
      });
    }
    function updateScore(){
      const answered = Object.keys(state.answers).filter(k=> state.order.includes(Number(k)));
      let score=0;
      answered.forEach(k=>{
        const idx=Number(k);
        const correct = quizData[idx].ans;
        if(state.answers[idx]===correct) score++;
      });
      state.score = score;
      state.total = state.order.length;
      scoreBox.textContent = `Score: ${score} / ${state.total}`;
    }
    function updateProgress(){
      const answeredCount = Object.keys(state.answers).filter(k=> state.order.includes(Number(k))).length;
      const pct = state.order.length ? Math.round(100*answeredCount/state.order.length) : 0;
      progress.style.width = pct+'%';
      progress.setAttribute('aria-valuenow', String(pct));
    }
    function start(){
      state.order = shuffle([...Array(quizData.length)].map((_,i)=>i)).slice(0,40);
      state.answers = {};
      state.score = 0; state.total = 40;
      renderQuiz();
    }
    function reset(){
      state.answers = {};
      state.score = 0;
      renderQuiz();
    }
    startQuiz.addEventListener('click', start);
    resetQuiz.addEventListener('click', reset);
    reviewBtn.addEventListener('click', ()=>{
      state.review = !state.review;
      reviewBtn.setAttribute('aria-pressed', String(state.review));
      renderQuiz();
    });
    // Auto-start for immediate use
    start();

    /* Print cheat sheet only */
    const printBtn=qs('#printBtn');
    printBtn.addEventListener('click', ()=>{
      // Open printable window with cheat sheet content
      const cheat=qs('#cheatContent').outerHTML;
      const w=window.open('', '_blank', 'noopener');
      if(!w) return;
      w.document.write(`<!DOCTYPE html><html><head><title>Cheat Sheet</title>
      <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"/>
      <style>
      body{font-family:${getComputedStyle(document.body).fontFamily};background:#fff;color:#000; margin:20px;}
      h3,h4{margin:10px 0}
      ul{margin:6px 0 12px}
      .kbd{font-family:monospace; border:1px solid #aaa; border-radius:4px; padding:2px 6px}
      </style>
      </head><body>${cheat}</body></html>`);
      w.document.close();
      w.focus();
      w.print();
    });

    /* Performance: defer any heavy DOM reads to idle (if available) */
    if('requestIdleCallback' in window){
      requestIdleCallback(()=>{/* potential analytics hook or precomputation */});
    }
  </script>
</body>
</html>